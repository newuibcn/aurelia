System.register(['aurelia-framework'], function(exports_1) {
    var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
        var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
        if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
        else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
        return c > 3 && r && Object.defineProperty(target, key, r), r;
    };
    var __metadata = (this && this.__metadata) || function (k, v) {
        if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
    };
    var aurelia_framework_1;
    var Packer;
    return {
        setters:[
            function (aurelia_framework_1_1) {
                aurelia_framework_1 = aurelia_framework_1_1;
            }],
        execute: function() {
            Packer = (function () {
                function Packer(_element) {
                    this._element = _element;
                    this.sorter = {
                        random: function (a, b) {
                            return Math.random() - 0.5;
                        },
                        w: function (a, b) {
                            return b.w - a.w;
                        },
                        h: function (a, b) {
                            return b.h - a.h;
                        },
                        a: function (a, b) {
                            return b.area - a.area;
                        },
                        max: function (a, b) {
                            return Math.max(b.w, b.h) - Math.max(a.w, a.h);
                        },
                        min: function (a, b) {
                            return Math.min(b.w, b.h) - Math.min(a.w, a.h);
                        },
                        height: (function (a, b) {
                            return this.sorter.msort(a, b, ['h', 'w']);
                        }).bind(this),
                        width: (function (a, b) {
                            return this.sorter.msort(a, b, ['w', 'h']);
                        }).bind(this),
                        area: (function (a, b) {
                            return this.sorter.msort(a, b, ['a', 'h', 'w']);
                        }).bind(this),
                        maxside: (function (a, b) {
                            return this.sorter.msort(a, b, ['max', 'min', 'h', 'w']);
                        }).bind(this),
                        msort: (function (a, b, criteria) {
                            var diff, n;
                            for (n = 0; n < criteria.length; n++) {
                                diff = this.sorter[criteria[n]](a, b);
                                if (diff != 0)
                                    return diff;
                            }
                            return 0;
                        }).bind(this),
                        now: function (blocks) {
                            blocks.sort(this.width);
                        }
                    };
                }
                Packer.prototype.attached = function () {
                    this.root = { x: 0, y: 0, w: $(this._element).width(), h: $(this._element).height() };
                    this.fit(this.getTiles(this._element.getElementsByTagName('paper-card')));
                };
                Packer.prototype.getTiles = function (elements) {
                    var tile, tiles = [];
                    for (var i = 0; i < elements.length; i++) {
                        tile = { node: elements[i], w: $(elements[i]).width(), h: $(elements[i]).height() };
                        tiles.push(tile);
                    }
                    tiles.sort(function (a, b) {
                        return a.h > b.h ? 1 :
                            a.h < b.h ? -1 : 0;
                    });
                    return tiles;
                };
                Packer.prototype.fit = function (tiles) {
                    var n, node, tile;
                    this.root = { x: 0, y: 0, w: tiles[0].w, h: tiles[0].h };
                    for (n = 0; n < tiles.length; n++) {
                        tile = tiles[n];
                        if (node = this.findNode(this.root, tile.w, tile.h)) {
                            tile.fit = this.splitNode(node, tile.w, tile.h);
                        }
                        else {
                            tile.fit = this.growNode(tile.w, tile.h);
                        }
                    }
                    for (var n = 0; n < tiles.length; n++) {
                        var tile = tiles[n];
                        if (tile.fit) {
                            var parentOffset = $(this._element).offset();
                            $(tile.node).offset({ left: parentOffset.left + tile.fit.x, top: parentOffset.top + tile.fit.y });
                        }
                    }
                };
                Packer.prototype.growNode = function (w, h) {
                    var canGrowDown = (w <= this.root.w);
                    var canGrowRight = (h <= this.root.h);
                    var shouldGrowRight = canGrowRight && (this.root.h >= (this.root.w + w));
                    var shouldGrowDown = canGrowDown && (this.root.w >= (this.root.h + h));
                    if (shouldGrowRight)
                        return this.growRight(w, h);
                    else if (shouldGrowDown)
                        return this.growDown(w, h);
                    else if (canGrowRight)
                        return this.growRight(w, h);
                    else if (canGrowDown)
                        return this.growDown(w, h);
                    else
                        return null;
                };
                Packer.prototype.growRight = function (w, h) {
                    var node;
                    this.root = {
                        used: true,
                        x: 0,
                        y: 0,
                        w: this.root.w + w,
                        h: this.root.h,
                        down: this.root,
                        right: { x: this.root.w, y: 0, w: w, h: this.root.h }
                    };
                    if (node = this.findNode(this.root, w, h))
                        return this.splitNode(node, w, h);
                    else
                        return null;
                };
                Packer.prototype.growDown = function (w, h) {
                    var node;
                    this.root = {
                        used: true,
                        x: 0,
                        y: 0,
                        w: this.root.w,
                        h: this.root.h + h,
                        down: { x: 0, y: this.root.h, w: this.root.w, h: h },
                        right: this.root
                    };
                    if (node = this.findNode(this.root, w, h))
                        return this.splitNode(node, w, h);
                    else
                        return null;
                };
                Packer.prototype.findNode = function (root, w, h) {
                    if (root.used)
                        return this.findNode(root.right, w, h) || this.findNode(root.down, w, h);
                    else if ((w <= root.w) && (h <= root.h))
                        return root;
                    else
                        return null;
                };
                Packer.prototype.splitNode = function (node, w, h) {
                    node.used = true;
                    node.down = { x: node.x, y: node.y + h, w: node.w, h: node.h - h };
                    node.right = { x: node.x + w, y: node.y, w: node.w - w, h: h };
                    return node;
                };
                Packer = __decorate([
                    aurelia_framework_1.customAttribute('packer'),
                    aurelia_framework_1.autoinject, 
                    __metadata('design:paramtypes', [Element])
                ], Packer);
                return Packer;
            })();
            exports_1("Packer", Packer);
        }
    }
});

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNvcmUvY29tcG9uZW50cy9hdHRyaWJ1dGVzL3BhY2tlci50cyJdLCJuYW1lcyI6WyJQYWNrZXIiLCJQYWNrZXIuY29uc3RydWN0b3IiLCJQYWNrZXIuYXR0YWNoZWQiLCJQYWNrZXIuZ2V0VGlsZXMiLCJQYWNrZXIuZml0IiwiUGFja2VyLmdyb3dOb2RlIiwiUGFja2VyLmdyb3dSaWdodCIsIlBhY2tlci5ncm93RG93biIsIlBhY2tlci5maW5kTm9kZSIsIlBhY2tlci5zcGxpdE5vZGUiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7OztZQUtBO2dCQXVESUEsZ0JBQW9CQSxRQUFpQkE7b0JBQWpCQyxhQUFRQSxHQUFSQSxRQUFRQSxDQUFTQTtvQkFqRDlCQSxXQUFNQSxHQUFHQTt3QkFFWkEsTUFBTUEsRUFBRUEsVUFBVUEsQ0FBQ0EsRUFBRUEsQ0FBQ0E7NEJBQ2xCLE1BQU0sQ0FBQyxJQUFJLENBQUMsTUFBTSxFQUFFLEdBQUcsR0FBRyxDQUFDO3dCQUMvQixDQUFDO3dCQUNEQSxDQUFDQSxFQUFFQSxVQUFVQSxDQUFDQSxFQUFFQSxDQUFDQTs0QkFDYixNQUFNLENBQUMsQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDO3dCQUNyQixDQUFDO3dCQUNEQSxDQUFDQSxFQUFFQSxVQUFVQSxDQUFDQSxFQUFFQSxDQUFDQTs0QkFDYixNQUFNLENBQUMsQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDO3dCQUNyQixDQUFDO3dCQUNEQSxDQUFDQSxFQUFFQSxVQUFVQSxDQUFDQSxFQUFFQSxDQUFDQTs0QkFDYixNQUFNLENBQUMsQ0FBQyxDQUFDLElBQUksR0FBRyxDQUFDLENBQUMsSUFBSSxDQUFDO3dCQUMzQixDQUFDO3dCQUNEQSxHQUFHQSxFQUFFQSxVQUFVQSxDQUFDQSxFQUFFQSxDQUFDQTs0QkFDZixNQUFNLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsR0FBRyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO3dCQUNuRCxDQUFDO3dCQUNEQSxHQUFHQSxFQUFFQSxVQUFVQSxDQUFDQSxFQUFFQSxDQUFDQTs0QkFDZixNQUFNLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsR0FBRyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO3dCQUNuRCxDQUFDO3dCQUVEQSxNQUFNQSxFQUFFQSxDQUFDQSxVQUFVQSxDQUFDQSxFQUFFQSxDQUFDQTs0QkFDbkIsTUFBTSxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxHQUFHLEVBQUUsR0FBRyxDQUFDLENBQUMsQ0FBQzt3QkFDL0MsQ0FBQyxDQUFDQSxDQUFDQSxJQUFJQSxDQUFDQSxJQUFJQSxDQUFDQTt3QkFDYkEsS0FBS0EsRUFBRUEsQ0FBQ0EsVUFBVUEsQ0FBQ0EsRUFBRUEsQ0FBQ0E7NEJBQ2xCLE1BQU0sQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLEtBQUssQ0FBQyxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsR0FBRyxFQUFFLEdBQUcsQ0FBQyxDQUFDLENBQUM7d0JBQy9DLENBQUMsQ0FBQ0EsQ0FBQ0EsSUFBSUEsQ0FBQ0EsSUFBSUEsQ0FBQ0E7d0JBQ2JBLElBQUlBLEVBQUVBLENBQUNBLFVBQVVBLENBQUNBLEVBQUVBLENBQUNBOzRCQUNqQixNQUFNLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUMsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLEdBQUcsRUFBRSxHQUFHLEVBQUUsR0FBRyxDQUFDLENBQUMsQ0FBQzt3QkFDcEQsQ0FBQyxDQUFDQSxDQUFDQSxJQUFJQSxDQUFDQSxJQUFJQSxD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Q2hCQSxDQUFDQSxDQUFDQSxDQUFDQSxHQUFHQSxDQUFDQSxDQUFDQSxDQUFDQSxHQUFHQSxDQUFDQSxDQUFDQSxHQUFHQSxDQUFDQSxDQUFDQTtvQkFDM0JBLENBQUNBLENBQUNBLENBQUFBO29CQUNGQSxNQUFNQSxDQUFDQSxLQUFLQSxDQUFDQTtnQkFDakJBLENBQUNBO2dCQUVPSCxvQkFBR0EsR0FBWEEsVUFBWUEsS0FBS0E7b0JBQ2JJLElBQUlBLENBQUNBLEVBQUVBLElBQUlBLEVBQUVBLElBQUlBLENBQUNBO29CQUNsQkEsSUFBSUEsQ0FBQ0EsSUFBSUEsR0FBR0EsRUFBRUEsQ0FBQ0EsRUFBRUEsQ0FBQ0EsRUFBRUEsQ0FBQ0EsRUFBRUEsQ0FBQ0EsRUFBRUEsQ0FBQ0EsRUFBRUEsS0FBS0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsRUFBRUEsQ0FBQ0EsRUFBRUEsS0FBS0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsRUFBRUEsQ0FBQ0E7b0JBQ3pEQSxHQUFHQSxDQUFBQSxDQUFDQSxDQUFDQSxHQUFHQSxDQUFDQSxFQUFFQSxDQUFDQSxHQUFHQSxLQUFLQSxDQUFDQSxNQUFNQSxFQUFFQSxDQUFDQSxFQUFFQSxFQUFDQSxDQUFDQTt3QkFDaENBLElBQUlBLEdBQUdBLEtBQUtBLENBQUNBLENBQUNBLENBQUNBLENBQUNBO3dCQUNkQSxFQUFFQSxDQUFBQSxDQUFDQSxJQUFJQSxHQUFHQSxJQUFJQSxDQUFDQSxRQUFRQSxDQUFDQSxJQUFJQSxDQUFDQSxJQUFJQSxFQUFFQSxJQUFJQSxDQUFDQSxDQUFDQSxFQUFFQSxJQUFJQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFBQSxDQUFDQTs0QkFDaERBLElBQUlBLENBQUNBLEdBQUdBLEdBQUdBLElBQUlBLENBQUNBLFNBQVNBLENBQUNBLElBQUlBLEVBQUVBLElBQUlBLENBQUNBLENBQUNBLEVBQUVBLElBQUlBLENBQUNBLENBQUNBLENBQUNBLENBQUNBO3dCQUNwREEsQ0FBQ0E7d0JBQUNBLElBQUlBLENBQUNB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Q0FBQ0E7d0JBQ0pBLENBQUNBLEVBQUVBLENBQUNBO3dCQUNKQSxDQUFDQSxFQUFFQSxJQUFJQSxDQUFDQSxJQUFJQSxDQUFDQSxDQUFDQTt3QkFDZEEsQ0FBQ0EsRUFBRUEsSUFBSUEsQ0FBQ0EsSUFBSUEsQ0FBQ0EsQ0FBQ0EsR0FBR0EsQ0FBQ0E7d0JBQ2xCQSxJQUFJQSxFQUFHQSxFQUFFQSxDQUFDQSxFQUFFQSxDQUFDQSxFQUFFQSxDQUFDQSxFQUFFQSxJQUFJQSxDQUFDQSxJQUFJQSxDQUFDQSxDQUFDQSxFQUFFQSxDQUFDQSxFQUFFQSxJQUFJQSxDQUFDQSxJQUFJQSxDQUFDQSxDQUFDQSxFQUFFQSxDQUFDQSxFQUFFQSxDQUFDQSxFQUFFQTt3QkFDckRBLEtBQUtBLEVBQUVBLElBQUlBLENBQUNBLElBQUlBO3FCQUNuQkEsQ0FBQ0E7b0JBQ0ZBLEVBQUVBLENBQUNBLENBQUNBLElBQUlBLEdBQUdBLElBQUlBLENBQUNBLFFBQVFBLENBQUNBLElBQUlBLENBQUNBLElBQUlBLEVBQUVBLENBQUNBLEVBQUVBLENBQUNBLENBQUNBLENBQUNBO3dCQUN0Q0EsTUFBTUEsQ0FBQ0EsSUFBSUEsQ0FBQ0EsU0FBU0EsQ0FBQ0EsSUFBSUEsRUFBRUEsQ0FBQ0EsRUFBRUEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7b0JBQ3RDQSxJQUFJQTt3QkFDQUEsTUFBTUEsQ0FBQ0EsSUFBSUEsQ0FBQ0E7Z0JBQ3BCQSxDQUFDQTtnQkFFT1AseUJBQVFBLEdBQWhCQSxVQUFpQkEsSUFBSUEsRUFBRUEsQ0FBQ0EsRUFBRUEsQ0FBQ0E7b0JBQ3ZCUSxFQUFFQSxDQUFBQSxDQUFDQSxJQUFJQSxDQUFDQSxJQUFJQSxDQUFDQTt3QkFDVEEsTUFBTUEsQ0FBQ0EsSUFBSUEsQ0FBQ0EsUUFBUUEsQ0FBQ0EsSUFBSUEsQ0FBQ0EsS0FBS0EsRUFBRUEsQ0FBQ0EsRUFBRUEsQ0FBQ0EsQ0FBQ0EsSUFBSUEsSUFBSUEsQ0FBQ0EsUUFBUUEsQ0FBQ0EsSUFBSUEsQ0FBQ0EsSUFBSUEsRUFBRUEsQ0FBQ0EsRUFBRUEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7b0JBQzdFQSxJQUFJQSxDQUFDQSxFQUFFQSxDQUFBQSxDQUFDQSxDQUFDQSxDQUFDQSxJQUFJQSxJQUFJQSxDQUFDQSxDQUFDQSxDQUFDQSxJQUFJQSxDQUFDQSxDQUFDQSxJQUFJQSxJQUFJQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQTt3QkFDbkNBLE1BQU1BLENBQUNBLElBQUlBLENBQUNBO29CQUNoQkEsSUFBSUE7d0JBQ0FBLE1BQU1BLENBQUNBLElBQUlBLENBQUNBO2dCQUNwQkEsQ0FBQ0E7Z0JBRU9SLDBCQUFTQSxHQUFqQkEsVUFBa0JBLElBQUlBLEVBQUVBLENBQUNBLEVBQUVBLENBQUNBO29CQUN4QlMsSUFBSUEsQ0FBQ0EsSUFBSUEsR0FBR0EsSUFBSUEsQ0FBQ0E7b0JBQ2pCQSxJQUFJQSxDQUFDQSxJQUFJQSxHQUFJQSxFQUFFQSxDQUFDQSxFQUFFQSxJQUFJQSxDQUFDQSxDQUFDQSxFQUFNQSxDQUFDQSxFQUFFQSxJQUFJQSxDQUFDQSxDQUFDQSxHQUFHQSxDQUFDQSxFQUFFQSxDQUFDQSxFQUFFQSxJQUFJQSxDQUFDQSxDQUFDQSxFQUFNQSxDQUFDQSxFQUFFQSxJQUFJQSxDQUFDQSxDQUFDQSxHQUFHQSxDQUFDQSxFQUFFQSxDQUFDQTtvQkFDNUVBLElBQUlBLENBQUNBLEtBQUtBLEdBQUdBLEVBQUVBLENBQUNBLEVBQUVBLElBQUlBLENBQUNBLENBQUNBLEdBQUdBLENBQUNBLEVBQUVBLENBQUNBLEVBQUVBLElBQUlBLENBQUNBLENBQUNBLEVBQU1BLENBQUNBLEVBQUVBLElBQUlBLENBQUNBLENBQUNBLEdBQUdBLENBQUNBLEVBQUVBLENBQUNBLEVBQUVBLENBQUNBLEVBQVdBLENBQUNBO29CQUM1RUEsTUFBTUEsQ0FBQ0EsSUFBSUEsQ0FBQ0E7Z0JBQ2hCQSxDQUFDQTtnQkF0S0xUO29CQUFDQSxtQ0FBZUEsQ0FBQ0EsUUFBUUEsQ0FBQ0E7b0JBQ3pCQSw4QkFBVUE7OzJCQXNLVkE7Z0JBQURBLGFBQUNBO1lBQURBLENBdktBLEFBdUtDQSxJQUFBO1lBdktELDJCQXVLQyxDQUFBIiwiZmlsZSI6ImNvcmUvY29tcG9uZW50cy9hdHRyaWJ1dGVzL3BhY2tlci5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxyXG4gKiBDcmVhdGVkIGJ5IGFsZXh2aXpjYWlubyBvbiAyMi8xMi8xNS5cclxuICovXHJcbmltcG9ydCB7Y3VzdG9tQXR0cmlidXRlLCBhdXRvaW5qZWN0fSBmcm9tICdhdXJlbGlhLWZyYW1ld29yayc7XHJcblxyXG5AY3VzdG9tQXR0cmlidXRlKCdwYWNrZXInKVxyXG5AYXV0b2luamVjdFxyXG5leHBvcnQgY2xhc3MgUGFja2Vye1xyXG5cclxuICAgIHB1YmxpYyByb290OiBhbnk7XHJcblxyXG4gICAgcHVibGljIHNvcnRlciA9IHtcclxuXHJcbiAgICAgICAgcmFuZG9tOiBmdW5jdGlvbiAoYSwgYikge1xyXG4gICAgICAgICAgICByZXR1cm4gTWF0aC5yYW5kb20oKSAtIDAuNTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIHc6IGZ1bmN0aW9uIChhLCBiKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBiLncgLSBhLnc7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBoOiBmdW5jdGlvbiAoYSwgYikge1xyXG4gICAgICAgICAgICByZXR1cm4gYi5oIC0gYS5oO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgYTogZnVuY3Rpb24gKGEsIGIpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGIuYXJlYSAtIGEuYXJlYTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIG1heDogZnVuY3Rpb24gKGEsIGIpIHtcclxuICAgICAgICAgICAgcmV0dXJuIE1hdGgubWF4KGIudywgYi5oKSAtIE1hdGgubWF4KGEudywgYS5oKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIG1pbjogZnVuY3Rpb24gKGEsIGIpIHtcclxuICAgICAgICAgICAgcmV0dXJuIE1hdGgubWluKGIudywgYi5oKSAtIE1hdGgubWluKGEudywgYS5oKTtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICBoZWlnaHQ6IChmdW5jdGlvbiAoYSwgYikge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zb3J0ZXIubXNvcnQoYSwgYiwgWydoJywgJ3cnXSk7XHJcbiAgICAgICAgfSkuYmluZCh0aGlzKSxcclxuICAgICAgICB3aWR0aDogKGZ1bmN0aW9uIChhLCBiKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnNvcnRlci5tc29ydChhLCBiLCBbJ3cnLCAnaCddKTtcclxuICAgICAgICB9KS5iaW5kKHRoaXMpLFxyXG4gICAgICAgIGFyZWE6IChmdW5jdGlvbiAoYSwgYikge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zb3J0ZXIubXNvcnQoYSwgYiwgWydhJywgJ2gnLCAndyddKTtcclxuICAgICAgICB9KS5iaW5kKHRoaXMpLFxyXG4gICAgICAgIG1heHNpZGU6IChmdW5jdGlvbiAoYSwgYikge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zb3J0ZXIubXNvcnQoYSwgYiwgWydtYXgnLCAnbWluJywgJ2gnLCAndyddKTtcclxuICAgICAgICB9KS5iaW5kKHRoaXMpLFxyXG5cclxuICAgICAgICBtc29ydDogKGZ1bmN0aW9uIChhLCBiLCBjcml0ZXJpYSkgeyAvKiBzb3J0IGJ5IG11bHRpcGxlIGNyaXRlcmlhICovXHJcbiAgICAgICAgICAgIHZhciBkaWZmLCBuO1xyXG4gICAgICAgICAgICBmb3IgKG4gPSAwOyBuIDwgY3JpdGVyaWEubGVuZ3RoOyBuKyspIHtcclxuICAgICAgICAgICAgICAgIGRpZmYgPSB0aGlzLnNvcnRlcltjcml0ZXJpYVtuXV0oYSwgYik7XHJcbiAgICAgICAgICAgICAgICBpZiAoZGlmZiAhPSAwKVxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBkaWZmO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiAwO1xyXG4gICAgICAgIH0pLmJpbmQodGhpcyksXHJcblxyXG4gICAgICAgIG5vdzogZnVuY3Rpb24oYmxvY2tzKSB7XHJcbiAgICAgICAgICAgIGJsb2Nrcy5zb3J0KHRoaXMud2lkdGgpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBjb25zdHJ1Y3Rvcihwcml2YXRlIF9lbGVtZW50OiBFbGVtZW50KXt9XHJcblxyXG4gICAgYXR0YWNoZWQoKXtcclxuICAgICAgICB0aGlzLnJvb3QgPSB7IHg6IDAsIHk6IDAsIHc6ICQodGhpcy5fZWxlbWVudCkud2lkdGgoKSwgaDogJCh0aGlzLl9lbGVtZW50KS5oZWlnaHQoKSB9O1xyXG4gICAgICAgIHRoaXMuZml0KHRoaXMuZ2V0VGlsZXModGhpcy5fZWxlbWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZSgncGFwZXItY2FyZCcpKSk7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBnZXRUaWxlcyhlbGVtZW50cyl7XHJcbiAgICAgICAgdmFyIHRpbGUsIHRpbGVzID0gW107XHJcbiAgICAgICAgZm9yKHZhciBpID0gMDsgaSA8IGVsZW1lbnRzLmxlbmd0aDsgaSsrKXtcclxuICAgICAgICAgICAgdGlsZSA9IHtub2RlOiBlbGVtZW50c1tpXSwgdzogJChlbGVtZW50c1tpXSkud2lkdGgoKSwgaDogJChlbGVtZW50c1tpXSkuaGVpZ2h0KCl9XHJcbiAgICAgICAgICAgIHRpbGVzLnB1c2godGlsZSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvL3RoaXMuc29ydGVyLm5vdyh0aWxlcyk7XHJcbiAgICAgICAgdGlsZXMuc29ydCgoYSwgYikgPT4ge1xyXG4gICAgICAgICAgICByZXR1cm4gYS5oID4gYi5oID8gMSA6XHJcbiAgICAgICAgICAgICAgICBhLmggPCBiLmggPyAtMSA6IDA7XHJcbiAgICAgICAgfSlcclxuICAgICAgICByZXR1cm4gdGlsZXM7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBmaXQodGlsZXMpe1xyXG4gICAgICAgIHZhciBuLCBub2RlLCB0aWxlO1xyXG4gICAgICAgIHRoaXMucm9vdCA9IHsgeDogMCwgeTogMCwgdzogdGlsZXNbMF0udywgaDogdGlsZXNbMF0uaCB9O1xyXG4gICAgICAgIGZvcihuID0gMDsgbiA8IHRpbGVzLmxlbmd0aDsgbisrKXtcclxuICAgICAgICAgIHRpbGUgPSB0aWxlc1tuXTtcclxuICAgICAgICAgICAgaWYobm9kZSA9IHRoaXMuZmluZE5vZGUodGhpcy5yb290LCB0aWxlLncsIHRpbGUuaCkpe1xyXG4gICAgICAgICAgICAgICAgdGlsZS5maXQgPSB0aGlzLnNwbGl0Tm9kZShub2RlLCB0aWxlLncsIHRpbGUuaCk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB0aWxlLmZpdCA9IHRoaXMuZ3Jvd05vZGUodGlsZS53LCB0aWxlLmgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmb3IodmFyIG4gPSAwIDsgbiA8IHRpbGVzLmxlbmd0aCA7IG4rKykge1xyXG4gICAgICAgICAgICB2YXIgdGlsZSA9IHRpbGVzW25dO1xyXG4gICAgICAgICAgICBpZiAodGlsZS5maXQpIHtcclxuICAgICAgICAgICAgICAgIHZhciBwYXJlbnRPZmZzZXQgPSAkKHRoaXMuX2VsZW1lbnQpLm9mZnNldCgpO1xyXG4gICAgICAgICAgICAgICAgJCh0aWxlLm5vZGUpLm9mZnNldCh7bGVmdDogcGFyZW50T2Zmc2V0LmxlZnQgKyB0aWxlLmZpdC54LCB0b3A6IHBhcmVudE9mZnNldC50b3AgKyB0aWxlLmZpdC55fSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBncm93Tm9kZSh3LCBoKXtcclxuICAgICAgICB2YXIgY2FuR3Jvd0Rvd24gID0gKHcgPD0gdGhpcy5yb290LncpO1xyXG4gICAgICAgIHZhciBjYW5Hcm93UmlnaHQgPSAoaCA8PSB0aGlzLnJvb3QuaCk7XHJcblxyXG4gICAgICAgIHZhciBzaG91bGRHcm93UmlnaHQgPSBjYW5Hcm93UmlnaHQgJiYgKHRoaXMucm9vdC5oID49ICh0aGlzLnJvb3QudyArIHcpKTsgLy8gYXR0ZW1wdCB0byBrZWVwIHNxdWFyZS1pc2ggYnkgZ3Jvd2luZyByaWdodCB3aGVuIGhlaWdodCBpcyBtdWNoIGdyZWF0ZXIgdGhhbiB3aWR0aFxyXG4gICAgICAgIHZhciBzaG91bGRHcm93RG93biAgPSBjYW5Hcm93RG93biAgJiYgKHRoaXMucm9vdC53ID49ICh0aGlzLnJvb3QuaCArIGgpKTsgLy8gYXR0ZW1wdCB0byBrZWVwIHNxdWFyZS1pc2ggYnkgZ3Jvd2luZyBkb3duICB3aGVuIHdpZHRoICBpcyBtdWNoIGdyZWF0ZXIgdGhhbiBoZWlnaHRcclxuXHJcbiAgICAgICAgaWYgKHNob3VsZEdyb3dSaWdodClcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZ3Jvd1JpZ2h0KHcsIGgpO1xyXG4gICAgICAgIGVsc2UgaWYgKHNob3VsZEdyb3dEb3duKVxyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5ncm93RG93bih3LCBoKTtcclxuICAgICAgICBlbHNlIGlmIChjYW5Hcm93UmlnaHQpXHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmdyb3dSaWdodCh3LCBoKTtcclxuICAgICAgICBlbHNlIGlmIChjYW5Hcm93RG93bilcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZ3Jvd0Rvd24odywgaCk7XHJcbiAgICAgICAgZWxzZVxyXG4gICAgICAgICAgICByZXR1cm4gbnVsbDsgLy8gbmVlZCB0byBlbnN1cmUgc2Vuc2libGUgcm9vdCBzdGFydGluZyBzaXplIHRvIGF2b2lkIHRoaXMgaGFwcGVuaW5nXHJcblxyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgZ3Jvd1JpZ2h0KHcsIGgpe1xyXG4gICAgICAgIHZhciBub2RlO1xyXG4gICAgICAgIHRoaXMucm9vdCA9IHtcclxuICAgICAgICAgICAgdXNlZDogdHJ1ZSxcclxuICAgICAgICAgICAgeDogMCxcclxuICAgICAgICAgICAgeTogMCxcclxuICAgICAgICAgICAgdzogdGhpcy5yb290LncgKyB3LFxyXG4gICAgICAgICAgICBoOiB0aGlzLnJvb3QuaCxcclxuICAgICAgICAgICAgZG93bjogdGhpcy5yb290LFxyXG4gICAgICAgICAgICByaWdodDogeyB4OiB0aGlzLnJvb3QudywgeTogMCwgdzogdywgaDogdGhpcy5yb290LmggfVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgaWYgKG5vZGUgPSB0aGlzLmZpbmROb2RlKHRoaXMucm9vdCwgdywgaCkpXHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnNwbGl0Tm9kZShub2RlLCB3LCBoKTtcclxuICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgZ3Jvd0Rvd24odywgaCl7XHJcbiAgICAgICAgdmFyIG5vZGU7XHJcbiAgICAgICAgdGhpcy5yb290ID0ge1xyXG4gICAgICAgICAgICB1c2VkOiB0cnVlLFxyXG4gICAgICAgICAgICB4OiAwLFxyXG4gICAgICAgICAgICB5OiAwLFxyXG4gICAgICAgICAgICB3OiB0aGlzLnJvb3QudyxcclxuICAgICAgICAgICAgaDogdGhpcy5yb290LmggKyBoLFxyXG4gICAgICAgICAgICBkb3duOiAgeyB4OiAwLCB5OiB0aGlzLnJvb3QuaCwgdzogdGhpcy5yb290LncsIGg6IGggfSxcclxuICAgICAgICAgICAgcmlnaHQ6IHRoaXMucm9vdFxyXG4gICAgICAgIH07XHJcbiAgICAgICAgaWYgKG5vZGUgPSB0aGlzLmZpbmROb2RlKHRoaXMucm9vdCwgdywgaCkpXHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnNwbGl0Tm9kZShub2RlLCB3LCBoKTtcclxuICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgZmluZE5vZGUocm9vdCwgdywgaCl7XHJcbiAgICAgICAgaWYocm9vdC51c2VkKVxyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5maW5kTm9kZShyb290LnJpZ2h0LCB3LCBoKSB8fCB0aGlzLmZpbmROb2RlKHJvb3QuZG93biwgdywgaCk7XHJcbiAgICAgICAgZWxzZSBpZigodyA8PSByb290LncpICYmIChoIDw9IHJvb3QuaCkpXHJcbiAgICAgICAgICAgIHJldHVybiByb290O1xyXG4gICAgICAgIGVsc2VcclxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBzcGxpdE5vZGUobm9kZSwgdywgaCl7XHJcbiAgICAgICAgbm9kZS51c2VkID0gdHJ1ZTtcclxuICAgICAgICBub2RlLmRvd24gID0geyB4OiBub2RlLngsICAgICB5OiBub2RlLnkgKyBoLCB3OiBub2RlLncsICAgICBoOiBub2RlLmggLSBoIH07XHJcbiAgICAgICAgbm9kZS5yaWdodCA9IHsgeDogbm9kZS54ICsgdywgeTogbm9kZS55LCAgICAgdzogbm9kZS53IC0gdywgaDogaCAgICAgICAgICB9O1xyXG4gICAgICAgIHJldHVybiBub2RlO1xyXG4gICAgfVxyXG59Il0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9
